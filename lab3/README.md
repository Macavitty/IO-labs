# Лабораторная работа 3

**Название:** "Разработка драйверов сетевых устройств"

**Цель работы:** получить знания и навыки разработки драйверов сетевых интерфейсов для операционной системы Linux.

## Описание функциональности драйвера
Драйвер создает виртуальный сетевой интерфейс и перехватывает UDP пакеты родительского интерфейса enp0s3, адресуемые на 80 порт. При получении такого пакета в  файл в директорию /proc/virt_net_if  выводится информация о нем:  порт отправителя и получателя. Статистика принятых пакетов выводится кольцевой буфер обмена.

## Инструкция по сборке
$ cd IO-labs/lab3 \
$ make


## Инструкция пользователя
1. Собрать проект
2. Загрузить модуль: $ sudo insmod virt_net_if.ko
3. Проверить системные логи: $ dmesg
4. Проверить, создан ли proc файл: $ ls -l /proc/virt_net_if
5. Отправить пакет на интерфейс: $ nc -u &lt;ip address&gt;  80
9. Проверить, что в файл в /proc записана информация о пакете: \# cat /proc/virt_net_if
3. Проверить, что в кольцевой буфер записана статистика: $ dmesg
5. Отправить пакет на интерфейс: $ nc -u &lt;ip address&gt;  81
9. Проверить, что в файл в /proc не записана информация о пакете: \# cat /proc/virt_net_if
3. Проверить, что в кольцевой буфер записана статистика: $ dmesg
6. Выгрузить модуль ядра: $ sudo rmmod virt_net_if

## Примеры использования
Компьютер А \
$ cd IO-labs/lab3 \
$ make \
$ sudo insmod virt_net_if.ko \
$ dmesg -w \

Компьютер В \
$ nc -u &lt;enp0s3_ip&gt;  80 \
 this text would be seen on computer A
^C

$ nc -u &lt;enp0s3_ip&gt;  88 \
 this text wouldn't be shown in statistics
^C

Компьютер A \
\# cat /proc/virt_net_if \
id of packet: 33, dest_port: 80, src_port: 64500 \
stat: rx_bytes: 40, rx_packets: 1 \
$ sudo rmmod virt_net_if
